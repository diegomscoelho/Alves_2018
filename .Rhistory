source('~/Documentos/Doutorado/others/NeuroCell/Jéssica/scripts/RT_qPCR_analysis.R', echo=TRUE)
library(readODS)
library(pheatmap)
library(devtools)
library(ggbiplot)
library(gplots)
library(rgl)
setwd("~/Documents/Doutorado/NeuroCell/Jessica/")
setwd("~/Documentos/Doutorado/others/NeuroCell/Jéssica/")
table <- data.frame(read.ods("Tab_final.ods",sheet = 1),stringsAsFactors = F)
colnames(table) <- table[1,]
table <- table[-1,]
table[,c(2:33)] <- sapply(table[,c(2:33)], as.numeric)
# Relative quantities table
table_relative <- table
table_relative[,c(2:33)] <- sapply(table_relative[,c(2:33)], function(x) 2^(x-38.868))
# Filling missing data table
table_missing <- table_relative
table_missing[is.na(table_missing)] <- 0.5
# Log2 table
table_log2 <- table_missing
table_log2[,c(2:33)] <- sapply(table_log2[,c(2:33)], log2)
rownames(table_log2) <- table_log2[,1]
table_log2[c(7:17),34] <- "Neurog2 + Sox2"
table_log2[c(18:24),34] <- "Ascl1 + Sox2"
# Autoscaled table
table_auto <- table_log2
table_auto[,c(2:33)] <- scale(table_auto[,c(2:33)],scale=T,center=T)
# Centered table
table_center <- table_log2
table_center[,c(2:33)] <- scale(table_center[,c(2:33)],scale=F,center=T)
annotation_col <- table_auto[,c(1,34,35)]
annotation_col[,c(1,3)] <- NULL
colnames(annotation_col) <- c("Plasmid")
color <- colorRampPalette( c("green", "black", "red"), space="rgb")(64)
Plasmid  <- c("navy", "purple")
names(Plasmid) <- c("Neurog2 + Sox2", "Ascl1 + Sox2")
anno_colors <- list(Plasmid = Plasmid)
cells <- c(7:12,15:23)
tf <- c(4,11,23,27)
fen <- c(2,10,18,22,26)
pheatmap(t(table_auto[cells,c(fen,tf)]),
show_rownames = T, cluster_rows = F,
show_colnames = F, cluster_cols = T,
annotation_col =  annotation_col, annotation_colors = anno_colors,
fontsize_row = 7,color = color)
ir.pca <- prcomp(table_log2[cells,tf], center = TRUE, scale = TRUE)
ir.species <- factor(c(replicate(9,"green"),replicate(6,"blue"))) #annotation_col[cells,1])
print(ir.pca)
g <- ggbiplot(ir.pca, obs.scale = 1, var.scale = 1,
groups = ir.species, ellipse = TRUE,
circle = TRUE)
g <- g + scale_color_discrete(name = '')
g <- g + theme(legend.direction = 'horizontal',
legend.position = 'top')
print(g)
pc <- princomp(table_auto[cells,tf], cor = T, scores = T)
ir.species <- factor(c(replicate(9,"green"),replicate(6,"blue"))) #annotation_col[cells,1])
plot(pc,type="lines")
plot3d(pc$scores[,1:3],col = ir.species,type = "s",xlab = "PC1(44,9%)",ylab = "PC2(26,1%)",zlab = "PC3(22,3%)")
ellips <- ellipse3d(pc$scores[,1:3],
centre=c(mean(pc$scores[,1]), mean(pc$scores[,2]), mean(pc$scores[,3])), level = 0.95)
ellips2 <- ellipse3d(pc$scores[,1:3],
centre=c(mean(pc$scores[1:8,1]), mean(pc$scores[1:8,2]), mean(pc$scores[1:8,3])), level = 0.95)
ellips3 <- ellipse3d(pc$scores[,1:3],
centre=c(mean(pc$scores[9:15,1]), mean(pc$scores[9:15,2]), mean(pc$scores[9:15,3])), level = 0.95)
plot3d(ellips, col = "red", alpha = 0.5, add = TRUE, box = FALSE,type = "wire")
plot3d(ellips2, col = "blue", alpha = 1, add = TRUE, box = FALSE,type = "wire")
plot3d(ellips3, col = "green", alpha = 1, add = TRUE, box = FALSE,type = "wire")
rgl.postscript("persp3dd.pdf","pdf")
plot3d(pc$scores[,1:3],col = ir.species,type = "s",xlab = "PC1(44,9%)",ylab = "PC2(26,1%)",zlab = "PC3(22,3%)")
ellips <- ellipse3d(pc$scores[,1:3],
centre=c(mean(pc$scores[,1]), mean(pc$scores[,2]), mean(pc$scores[,3])), level = 0.95)
ellips2 <- ellipse3d(pc$scores[,1:3],
centre=c(mean(pc$scores[1:8,1]), mean(pc$scores[1:8,2]), mean(pc$scores[1:8,3])), level = 0.95)
ellips3 <- ellipse3d(pc$scores[,1:3],
centre=c(mean(pc$scores[9:15,1]), mean(pc$scores[9:15,2]), mean(pc$scores[9:15,3])), level = 0.95)
plot3d(ellips, col = "red", alpha = 0.5, add = TRUE, box = FALSE,type = "wire")
plot3d(ellips2, col = "blue", alpha = 1, add = TRUE, box = FALSE,type = "wire")
plot3d(ellips3, col = "green", alpha = 1, add = TRUE, box = FALSE,type = "wire")
pheatmap(t(table_auto[cells,]),
show_rownames = T, cluster_rows = F,
show_colnames = F, cluster_cols = T,
annotation_col =  annotation_col, annotation_colors = anno_colors,
fontsize_row = 7,color = color)
pheatmap(t(table_auto[cells,c(fen,tf)]),
show_rownames = T, cluster_rows = F,
show_colnames = F, cluster_cols = T,
annotation_col =  annotation_col, annotation_colors = anno_colors,
fontsize_row = 7,color = color)
View(table_auto)
pheatmap(t(table_auto[cells,c(2:21)]),
show_rownames = T, cluster_rows = F,
show_colnames = F, cluster_cols = T,
annotation_col =  annotation_col, annotation_colors = anno_colors,
fontsize_row = 7,color = color)
pheatmap(t(table_auto[cells,c(2:24)]),
show_rownames = T, cluster_rows = F,
show_colnames = F, cluster_cols = T,
annotation_col =  annotation_col, annotation_colors = anno_colors,
fontsize_row = 7,color = color)
pheatmap(t(table_auto[cells,c(2:29)]),
show_rownames = T, cluster_rows = F,
show_colnames = F, cluster_cols = T,
annotation_col =  annotation_col, annotation_colors = anno_colors,
fontsize_row = 7,color = color)
pheatmap(t(table_auto[cells,c(2:33)]),
show_rownames = T, cluster_rows = F,
show_colnames = F, cluster_cols = T,
annotation_col =  annotation_col, annotation_colors = anno_colors,
fontsize_row = 7,color = color)
colnames(table_auto)
mes <- c(3,7,30)
pheatmap(t(table_auto[cells,mes]),
show_rownames = T, cluster_rows = F,
show_colnames = F, cluster_cols = T,
annotation_col =  annotation_col, annotation_colors = anno_colors,
fontsize_row = 7,color = color)
pheatmap(t(table_auto[cells,mes]),
show_rownames = T, cluster_rows = F,
show_colnames = T, cluster_cols = T,
annotation_col =  annotation_col, annotation_colors = anno_colors,
fontsize_row = 7,color = color)
dim(table_auto)
table_auto(cells)
table_auto
table_auto[35]
table_auto[35,]
table_auto[34,]
table_auto[2200],]
table_auto[2200,]
table_auto[12,]
table_auto[,34]
subset(table_auto, table_auto$`#Plasmideos` %in% "GFP Dsred")
subset(table_auto, table_auto$`#Plasmideos` %in% "GFP Dsred")[,msc]
subset(table_auto, table_auto$`#Plasmideos` %in% "GFP Dsred")[,mes]
mean(subset(table_auto, table_auto$`#Plasmideos` %in% "GFP Dsred")[,mes])
control <- subset(table_auto, table_auto$`#Plasmideos` %in% "GFP Dsred")[,mes]
ascl1 <- subset(table_auto, table_auto$`#Plasmideos` %in% "Neurog2 + Sox2")[,mes]
neurog2 <- subset(table_auto, table_auto$`#Plasmideos` %in% "Ascl1 + Sox2")[,mes]
View(ascl1)
mean(control)
colMeans(control)
View(control)
control <- colMeans(subset(table_auto, table_auto$`#Plasmideos` %in% "GFP Dsred")[,mes])
ascl1 <- colMeans(subset(table_auto, table_auto$`#Plasmideos` %in% "Neurog2 + Sox2")[,mes])
neurog2 <- colMeans(subset(table_auto, table_auto$`#Plasmideos` %in% "Ascl1 + Sox2")[,mes])
ascl1
control
cbind(control,ascl1)
cbind(control,ascl1,neurog2)
neurog2
control <- colMeans(subset(table_auto, table_auto$`#Plasmideos` %in% "GFP Dsred")[,mes])
neurog2 <- colMeans(subset(table_auto, table_auto$`#Plasmideos` %in% "Neurog2 + Sox2")[,mes])
ascl1 <- colMeans(subset(table_auto, table_auto$`#Plasmideos` %in% "Ascl1 + Sox2")[,mes])
table_auto$`#Plasmideos`
subset(table_auto, table_auto$`#Plasmideos` %in% "Ascl1 + Sox2")[,mes]
ascl1 <- colMeans(subset(table_auto, table_auto$`#Plasmideos` %in% "Ascl1 + Sox2")[,mes], na.rm = T)
ascl1
control <- colMeans(subset(table_auto, table_auto$`#Plasmideos` %in% "GFP Dsred")[,mes])
ascl1 <- colMeans(subset(table_auto, table_auto$`#Plasmideos` %in% "Ascl1 + Sox2")[,mes], na.rm = T)
neurog2 <- colMeans(subset(table_auto, table_auto$`#Plasmideos` %in% "Neurog2 + Sox2")[,mes])
cbind(control,ascl1,neurog2)
med <- cbind(control,ascl1,neurog2)
pheatmap(med,
show_rownames = T, cluster_rows = F,
show_colnames = F, cluster_cols = T,
annotation_col =  annotation_col, annotation_colors = anno_colors,
fontsize_row = 7,color = color)
pheatmap(med,
show_rownames = T, cluster_rows = F,
show_colnames = T, cluster_cols = F,
fontsize_row = 7,color = color)
